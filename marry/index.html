<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--页面核心样式-->
    <link rel="stylesheet" type="text/css" href="../css/font.css" />
    <link rel="stylesheet" type="text/css" href="../css/tool.css" />
    <!--页面核心JS-->
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/uaredirect.js"></script>
    <script type="text/javascript" src="../js/html2canvas.min.js"></script>
    <!-- <script type="text/javascript" src="../js/yi.min.js"></script> -->
    <script type="text/javascript" src="../js/lunartool.js"></script>

    <!-- <script type="text/javascript">browserRedirect("/m");</script> -->
    <link rel="icon" type="image/svg" href="../images/sleepcat.gif">
    <title>ORTC</title>
</head>
<body class="Ali-DFDK black">
    <div class="main">
        <canvas class="canvasbg" id="background"></canvas>
        <div class="header">
            <div class="logo-container">
                <img class="logo portrait" src="../images/sleepcat.gif" alt="logo">
                <div>
                    <div class="title">ORTC</div>
                    <div class="sub-title">百宝阁</div>
                </div>
            </div>
        </div>
        <!-- 右侧悬浮Tips -->
        <div class="nav-button-wrap">
            <div class="nav-button-item">
                <a class="nav-backtop" href="javascript:window.scrollTo({ top: 0, behavior: 'smooth' })">
                    <img class="nav-button-img" src="../images/nav-top.png">
                </a>
            </div>
            <div class="nav-button-item">
                <a href="http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=G8GZ1XGfQoypNSFz79BNmF06xOkhKt5h&authKey=6wQcUEbSlL9sHcNv4gtr7jS9Mmz03wjxUAEsLTh4KhOSECC4EpBaMe2nEW%2BZJoas&noverify=0&group_code=308811655">
                    <img class="nav-button-img" src="../images/nav-qqgroup.png">
                </a>
                <div class="qqgroup-tip">QQ群：308811655</div>
            </div>
            <div class="nav-button-item">
                <a href="javascript:void(0);" onclick="musicPlay();">
                    <img class="nav-button-img" src="../images/hsh-gd.jpg" style="border-radius: 13px;width: 40px;height: 40px;" alt="播放/暂停">
                </a>
                <div class="musicAudio-tip" >
                    <!-- controls  style="display: none;"-->
                    <audio class="musicAudioStyle" id="musicAudio" >
                        <source src="../music/hljxq.mp3" type="audio/mp3" />
                    </audio>
                </div>
            </div>
        </div>
        <div id="html-form" style="width: 430px;background: #803333;margin: auto;">
            <div class="form-group">
                <label for="name">新郎：</label>
                <input type="text" id="name-xl" name="name-xl" placeholder="请输入新郎姓名">
            </div>
            <div class="form-group">
                <label for="name">新娘：</label>
                <input type="text" id="name-xn" name="name-xn" placeholder="请输入新娘姓名">
            </div>
            <div class="form-group">
                <label for="name">举办时间：</label>
                <input type="datetime-local" id="datetime" name="datetime" placeholder="请输入举办时间">
            </div>
            <div class="form-group">
                <label for="message">婚宴地址：</label>
                <textarea id="address" name="address" rows="4" placeholder="请输入您的地址"></textarea>
            </div>
            <div class="form-group button-group">
                <button type="button" onclick="createHtml();">生成页面</button>
            </div>
        </div>
        <div id="content-main" class="center" style=" margin: auto;background: #FFF;width: 430px;">
            <div class="center-content" style="padding: 10px 15px 10px 15px;border-bottom: 1px #000 solid;">
                <div style="height: 19px;color: #000;">
                    <span id="xl-name-span">新郎</span><span class="redfont">❤</span><span id="xn-name-span">新娘</span>
                </div>
                <div class="redfont">
                    <span style="padding-right: 5px;">钟于</span>
                    <span style="padding-right: 5px;">忠于</span>
                    <span style="padding-right: 5px;">衷于</span>
                    <span >终于</span>
                </div>
            </div>
            <div class="center-content">
                <div style="background-color: #a53208; width: 280px;height: 115px;margin: 5px;padding: 5px;">
                    <div style="padding: 5px;border:2px #fff solid;">
                        <div style="font-size:50px;border-bottom: 2px #fff solid;text-align: center;">
                            <span >吾</span>
                            <span >家</span>
                            <span >有</span>
                            <span >囍</span>
                        </div>
                        <div style="font-size:16px;margin: 3px;text-align: center;">
                            <span id="xl-name-span2">王二麻</span><span>&</span><span id="xn-name-span2">李三芳</span>
                            <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                            <span>喜结良缘</span>
                        </div>
                    </div>
                </div>
                <div style="border: 1px #000000 solid;color: #fff;width: 130px;height: 115px;margin: 5px;padding: 3px; display: flex;;justify-content: space-between;">
                    <div style="padding:15px 5px 10px 5px;width: 30px;height: 108px;font-size:20px;background-color: rgb(23,77,135); display: flex;flex-direction: column;vertical-align: middle;">
                        <span>第</span>
                        <span>&nbsp;1</span>  
                        <span>期</span>    
                    </div>
                    <div style="padding:5px;width: 90px;height: 108px;background-color: #a53208;display: flex;;justify-content: space-between;">
                        <div>
                            <div id="hl_year" style="padding:3px 0px 0px 3px;height: 30px;font-size:20px;" >2024</div>
                            <div style="font-size:25px;">
                                <div id="hl_month" style="text-align: left;">11</div>
                                <div style="transform: rotate(-45deg);border-bottom: 2px #fff solid;"></div>
                                <div id="hl_day" style="text-align: right;">28</div>
                            </div>
                        </div>
                        <div style="font-size:25px; padding-left: 5px;">
                            <span>日</span>
                            <span>&nbsp;</span> 
                            <span>期</span>  
                        </div>
                    </div>
                </div>
            </div>
            <div class="center-content">
                <div class="ivu-annex" style="margin: 5px;">
                    <img id="img-hz" class="imghz" src="../images/wallhaven-img.jpg">
                    <input class="ivu-input-file " type="file" accept="image/gif,image/jpeg,image/jpg,image/png" style="display:none"/>
                </div>
                <div style="width: 130px;text-align: center;">
                    <div class="redfont" style="font-size: 80px;">
                        囍
                    </div>
                    <div style="height: 200px;color: #000; display: flex;flex-direction: row-reverse;">
                        <div class="book redline-left">喜今日赤绳系定</div>
                        <div class="book redline-left">珠联璧合</div>
                        <div class="book redline-left">卜他年白头永偕</div>
                        <div class="book ">桂馥兰馨ㅤㅤㅤ此证</div>
                    </div>
                </div>
            </div>
            <div class="redfont" style="font-size: 60px;text-align: center;">
                我们结婚啦！
            </div>
            <div class="center-content" style="padding: 20px 0px; border-bottom: #000 2px solid;">
                <div style="padding:0px 0px 0px 20px;">
                    <div style="width: 150px;color: #000;border-bottom: #a53208 2px solid;padding-bottom: 10px;">新郎：<span id="xl-name-span3">&nbsp;&nbsp;王二麻</span></div>
                    <div style="width: 150px;color: #000;border-bottom: #a53208 2px solid;padding:10px 0px;">新娘：<span id="xn-name-span3">&nbsp;&nbsp;李三芳</span></div>
                    <div class="redfont" style="width: 200px;padding-top: 20px;">
                        <span>婚宴地址：</span></br>
                        <span id="hl_dz">
                            中国北京市东城区王府井胡同56号国际大酒店
                        </span>
                    </div>
                    <div class="redfont" style="width: 200px;padding-top: 20px;">
                        <span>婚宴时间：</span></br>
                        <span id="nl_dt">
                            农历十月十九日 上午11:00
                        </span>
                    </div>
                </div>
                <div style="display: flex;">
                    <div class="" style="width: 30px;display: flex;flex-direction: row-reverse; text-align: center;">
                        <div style="width: 30px;">
                            <span class="redfont" style="font-size: 25px;">宜嫁娶</span>
                            <br/><br/>
                            <span id="lunar_year" style="color: #000;">后加年</span>
                        </div>
                    </div>
                    <div style="color: #a53208;width: 150px;border-left: #a53208 1px solid;text-align: center;">
                        <div id="Solar_ym" style="font-size: 25px;margin: 5px 15px;padding-bottom:5px; border-bottom: 1px #000 solid;">2024/12</div>
                        <div id="Solar_d" style="font-size: 35px;margin: 5px 15px;padding-bottom:5px;border-bottom: 1px #000 solid;">28</div>
                        <div id="lunar_date">十月十九</div>
                        <div style="padding-top: 10px;text-align: center;width: 150px;display: flex;align-content: space-around;flex-direction: column;flex-wrap: wrap;">
                            <div style="width: 70px;height: 35px;background-color: #a53208;color: #FFF;font-size: 25px;">
                                良缘
                            </div>
                            <div style="width: 70px;height: 35px;background-color: #a53208;color: #FFF;font-size: 25px;">
                                永结
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="center-content" style="padding-bottom: 20px;text-align: center;display: flex;justify-content: center;">
                <div style="font-size: 20px; margin-top: -12px;width: 28px;height:28px;background:#a53208;color:#FFF">囍</div>
            </div>
        </div>
        <div id="savePng" class="form-group button-group" style="text-align: center;display: none;">
            <button type="button" onclick="takeScreenshot();">保存页面</button>
            <button type="button" onclick="returnMess();">重新输入</button>
        </div>
        <!-- 底部copyright等 -->
        <div class="footer-placeholder"></div>
        <div class="footer">
            <div class="copyright"><span>Copyright © 2024 - 2099 ORTC. All Rights Reserved.</span></div>
        </div>
    </div>
    <style>
        .form-group {
            padding: 5px 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input[type="text"],
        .form-group input[type="datetime-local"],
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            outline: none;
            resize: vertical;
        }
        /* 按钮组样式 */
        .button-group {
            padding: 5px 20px;
        }

        .button-group button {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
        }
        .center-content{
            display: flex;justify-content: space-between;width: auto; 
        }
        .book{
            padding-top: 5px;width: 30px;
        }
        .redline-left{
            border-left: #a53208 2px solid;
        }
        .redfont{
            color: #a53208;
        }
        .center{
            display: none;
        }
        .imghz{
            /* object-fit: scale-down; */
            width: 300px;
            height: 300px;
            max-width: 100%;
            max-height: 100%;
        }
    </style>
    <script type="application/javascript" src="../js/tool.js" charset="utf-8"></script>
    <script>
        //上传结婚照
        let annex = document.querySelector(".ivu-annex");
        annex.addEventListener("click", function() {
            let fileDomain = document.querySelector(".ivu-input-file");
            fileDomain.click();
        }); 
        let fileInput = document.querySelector(".ivu-input-file");
        var fileList = [];
        fileInput.addEventListener("change", function() {
            let operate = document.querySelector(".ivu-annex");
            let file = fileInput.files[0];
            if (window.FileReader && file) {
                var reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onloadend = function(e) {
                    let imgBase64 = e.target.result;
                    let order = fileList.length;
                    var img_hz = document.getElementById("img-hz");
                    img_hz.src = ''+imgBase64;
                };
            }
        })


        // console.log(Lunar.fromDate(new Date()).toFullString());
        // console.log(Solar.fromYmd(2016, 1, 1).toFullString());
        function createHtml(){
            var xl = document.getElementById('name-xl').value;
            var xn = document.getElementById('name-xn').value;
            var dt = document.getElementById('datetime').value;
            var dz = document.getElementById('address').value;

            $("#xl-name-span").html(xl);
            $("#xn-name-span").html(xn);
            $("#xl-name-span2").html(xl);
            $("#xn-name-span2").html(xn);
            $("#xl-name-span3").html("&nbsp;&nbsp;"+xl);
            $("#xn-name-span3").html("&nbsp;&nbsp;"+xn);
            var ldt = Lunar.fromDate(new Date());
            var sdt = Solar.fromDate(new Date());
            if(dt){
                ldt = Lunar.fromDate(new Date(dt));
                sdt = Solar.fromDate(new Date(dt));
            }
            $("#hl_year").html(sdt.getYear());
            $("#hl_month").html(sdt.getMonth());
            $("#hl_day").html(sdt.getDay());
            $("#nl_dt").html("农历"+ldt.getMonthInChinese()+"月"+ldt.getDayInChinese()+"&nbsp;上午"+ldt.getHour()+"时");
            $("#hl_dz").html(dz);

            $("#Solar_ym").html(sdt.getYear()+"/"+sdt.getMonth())
            $("#Solar_d").html(sdt.getDay())
            $("#lunar_year").html(ldt.getYearInGanZhi()+"年")
            $("#lunar_date").html(ldt.getMonthInChinese()+"月"+ldt.getDayInChinese())

            var cm = document.getElementById('content-main');
            $("#content-main").show();
            $("#savePng").show();
            $("#html-form").hide();
        }
        function returnMess(){
            $("#html-form").show();
            $("#content-main").hide();
            $("#savePng").hide();
        }

        // 保存为图片
        function takeScreenshot(){
            const element = document.getElementById('content-main'); // 获取要转换的HTML元素
            html2canvas(element).then((canvas) => {
                canvas.toBlob((blob) => {
                    if (blob) {
                        const link = document.createElement('a');
                        link.href = URL.createObjectURL(blob);
                        link.download = 'photo.png';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                    }
                });
            });
        }

    </script>
</body>
</html>